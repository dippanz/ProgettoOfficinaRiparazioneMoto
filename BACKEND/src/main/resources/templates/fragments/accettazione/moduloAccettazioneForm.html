<th:block th:fragment="moduloAccettazioneForm">
    <form
        id="moduloAccettazioneForm"
        th:action="@{/accettazione/process_modulo_accettazione}"
        method="post"
        th:object="${clienteVeicoloDto}">
        <div class="form-section" id="motoSelected">
            <h3>Dati Cliente</h3>
            <label>
                <input type="checkbox" id="clienteEsistenteCheckbox"> Il cliente
                è già presente
                nel sistema?
            </label>
            <div id="nuovoClienteSection">
                <div class="form-group mb-3">
                    <label for="nome">Nome:</label>
                    <input type="text" th:field="*{nome}" id="nome" name="nome"
                        placeholder="Inserisci il nome del cliente"
                        minlength="2" maxlength="50">
                    <p th:if="${#fields.hasErrors('nome')}" th:errors="*{nome}"
                        class="error"></p>
                </div>

                <div class="form-group mb-3">
                    <label for="cognome">Cognome:</label>
                    <input type="text" th:field="*{cognome}" id="cognome"
                        name="cognome"
                        placeholder="Inserisci il cognome del cliente"
                        minlength="2" maxlength="50">
                    <p th:if="${#fields.hasErrors('cognome')}"
                        th:errors="*{cognome}" class="error"></p>
                </div>

                <div class="form-group mb-3">
                    <label for="email">Email:</label>
                    <input type="email" th:field="*{email}" id="email"
                        name="email"
                        placeholder="Inserisci l'email del cliente" required>
                    <p th:if="${#fields.hasErrors('email')}"
                        th:errors="*{email}"
                        class="error"></p>
                    <p th:if="${#fields.hasErrors('emailValid')}"
                        th:errors="*{emailValid}"
                        class="error"></p>
                </div>

                <div class="form-group mb-3">
                    <label for="telefono">Telefono:</label>
                    <input type="text" th:field="*{telefono}" id="telefono"
                        name="telefono"
                        pattern="^\\+?[0-9]{1,3}?\\s?[0-9]{6,10}$"
                        placeholder="Inserisci il numero di telefono">
                    <p th:if="${#fields.hasErrors('telefono')}"
                        th:errors="*{telefono}" class="error"></p>
                </div>
            </div>
            <div id="clienteEsistenteSection" style="display: none;">
                <div class="form-group mb-3">
                    <label for="selectClienti" class="form-label">
                        Seleziona un cliente:</label>
                    <select id="selectClienti"
                        name="idCliente"
                        class="selectpicker"
                        data-live-search="true"
                        title="Scegli un cliente...">
                    </select>
                </div>
            </div>
        </div>

        <div class="form-section">
            <h3>Dati Veicolo</h3>
            <label>
                <input type="checkbox" id="motoEsistenteCheckbox">
                Il veicolo è già presente nel sistema?
            </label>

            <div id="nuovaMotoSection">
                <div class="form-group mb-3">
                    <label for="targa">Targa:</label>
                    <input type="text" th:field="*{targa}" id="targa"
                        name="targa"
                        pattern="^[A-Z]{1,3}[0-9]{1,4}[A-Z]{1,3}$|^[A-Z]{1,3}-[0-9]{1,4}-[A-Z]{1,3}$|^[A-Z0-9]{6,8}$"
                        placeholder="Inserisci la targa del veicolo" required>
                    <p th:if="${#fields.hasErrors('targa')}"
                        th:errors="*{targa}"
                        class="error"></p>
                </div>

                <div class="form-group mb-3">
                    <label for="modello">Modello:</label>
                    <input type="text" th:field="*{modello}" id="modello"
                        name="modello"
                        maxlength="80"
                        placeholder="Inserisci il modello del veicolo">
                    <p th:if="${#fields.hasErrors('modello')}"
                        th:errors="*{modello}"
                        class="error"></p>
                </div>
            </div>
            <div id="motoEsistenteSection" style="display: none;">
                <div class="form-group mb-3">
                    <label for="selectMoto" class="form-label">
                        Seleziona una moto:</label>
                    <select id="selectMoto"
                        name="moto"
                        class="selectpicker"
                        data-live-search="true"
                        title="Scegli una moto...">
                    </select>
                </div>
            </div>
        </div>

        <div class="form-group mb-3">
            <label for="descrizione">Descrizione del problema:</label>
            <input type="text" th:field="*{descrizione}" id="descrizione"
                name="descrizione"
                maxlength="500"
                placeholder="Descrivi il problema segnalato">
            <p th:if="${#fields.hasErrors('descrizione')}"
                th:errors="*{descrizione}" class="error"></p>
        </div>

        <div class="row justify-content-between">
            <button type="submit" class="btn btn-primary ml-3">
                Registra Veicolo</button>
            <button type="button" class="btn btn-secondary mr-3"
                onclick="window.history.back()">Indietro</button>
        </div>

    </form>
</th:block>
